import sqlite3

# Список угроз для вставки
threats = [
    "Пожар",
    "Затопление",
    "Разрушение оборудования или среды",
    "Природные, экологические, социальные бедствия",
    "Сбой системы кондиционирования/отопления",
    "Сбой системы телефонии",
    "Сбой электросети",
    "Сбой телекоммуникационной сети",
    "Сбой в работе сервис-провайдеров",
    "Сбой оборудования",
    "Перехват информации / шпионаж",
    "Прослушивание",
    "Кража устройств, накопителей, документов",
    "Потеря устройств, накопителей, документов",
    "Восстановление информации по отработанному оборудованию, накопителям",
    "Плохое планирование или отсутствие адаптации",
    "Раскрытие чувствительной информации",
    "Манипуляция аппаратным или программным обеспечением",
    "Манипуляция информацией",
    "Несанкционированный доступ к ИТ-системам или информации (в электронном виде)",
    "Выход из строя устройства или накопителя информации",
    "Ошибки в работе устройств или систем",
    "Неисправность устройств или систем",
    "Недоступность сервиса",
    "Потеря целостности критической информации",
    "Отсутствие ресурсов",
    "Уязвимости или ошибки ПО",
    "Нарушение законодательства",
    "Нарушение договорных обязательств",
    "Несанкционированное использование или администрирование устройств или систем",
    "Неприемлемое использование или администрирование устройств или систем",
    "Использование нелицензионного ПО",
    "Нелегальная обработка данных",
    "Злоупотребления полномочиями/правами доступа",
    "Отсутствие персонала",
    "Отсутствие компетентности у персонала",
    "Атака",
    "Принуждение, вымогательство или коррумпированность",
    "Кража личности",
    "Информация из недостоверных источников",
    "Оборудование от недоверенных поставщиков",
    "Злоупотребление критической информацией",
    "Вредоносное ПО",
    "Отказ в обслуживании",
    "Саботаж",
    "Социальная инженерия",
    "Потеря резервных копий",
    "Недоступность резервных копий",
    "Несанкционированный доступ в помещение"
]

def populate_threats():
    # Подключение к базе данных
    with sqlite3.connect('risk_assessment.db') as conn:
        cursor = conn.cursor()
        
        # Проверка наличия таблицы threats
        cursor.execute("SELECT name FROM sqlite_master WHERE type='table' AND name='threats'")
        if not cursor.fetchone():
            print("Ошибка: таблица 'threats' не существует в базе данных.")
            return
        
        # Подсчёт существующих угроз
        cursor.execute('SELECT COUNT(*) FROM threats')
        initial_count = cursor.fetchone()[0]
        print(f"Угроз в базе до вставки: {initial_count}")
        
        # Вставка угроз
        inserted = 0
        skipped = 0
        for threat in threats:
            try:
                cursor.execute('INSERT INTO threats (name) VALUES (?)', (threat,))
                inserted += 1
            except sqlite3.IntegrityError:
                # Пропускаем, если угроза уже существует (UNIQUE constraint)
                skipped += 1
        
        # Подтверждение изменений
        conn.commit()
        
        # Подсчёт угроз после вставки
        cursor.execute('SELECT COUNT(*) FROM threats')
        final_count = cursor.fetchone()[0]
        print(f"Угроз в базе после вставки: {final_count}")
        print(f"Добавлено угроз: {inserted}")
        print(f"Пропущено (уже существуют): {skipped}")

if __name__ == "__main__":
    populate_threats()