import sqlite3

# Список уязвимостей с категориями
vulnerabilities = [
    ("Information", "Отсутствие 'logout' под оставление работником рабочей станции"),
    ("Information", "Отсутствие или несовершенство системы резервного копирования информации"),
    ("Information", "Недостаток требований или контроля информационной безопасности при работе с клиентами и/или третьими сторонами"),
    ("Information", "Отсутствие или неэффективность идентификации и аутентификации пользователя"),
    ("Information", "Отсутствие или неэффективность обучения персонала"),
    ("Information", "Отсутствие определенного дисциплинарного процесса в случае инцидента информационной безопасности"),
    ("Information", "Отсутствие записей о работе пользователей в журналах аудита"),
    ("Information", "Отсутствие классификации информации"),
    ("Information", "Отсутствие должного определения ответственности за информационную безопасность"),
    ("Information", "Отсутствие регулярных аудитов"),
    ("Information", "Отсутствие резервного оборудования/программного обеспечения"),
    ("Information", "Доступность сервисов, в которых нет необходимости"),
    ("Information", "Злонамеренные действия персонала"),
    ("Information", "Возможность использования оборудования/программного обеспечения не по назначению"),
    ("Information", "Наличие незащищенного конфиденциального трафика"),
    ("Information", "Опасная архитектура сети"),
    ("Information", "Небрежность/неосведомленность персонала"),
    ("Information", "Несовершенное управление паролями доступа"),
    ("Information", "Недостаточный контроль за перемещением имущества"),
    ("Information", "Недостаточный контроль над функционированием и управлением сетью/программным обеспечением"),
    ("Information", "Недостаточно эффективная система распределения прав доступа к информации"),
    ("Information", "Недостаточная защищенность узла доступа к общим сетям (например, интернет) от внешних злоумышленников"),
    ("Information", "Неэффективная охрана и пропускной режим для посетителей"),
    ("Information", "Неэффективная процедура распространения ключей"),
    ("Information", "Незащищенное соединение с публичными сетями"),
    ("Information", "Незащищенное хранение данных/документов"),
    ("Information", "Неконтролируемое копирование информации"),
    ("Information", "Неправильные настройки установки программного обеспечения"),
    ("Information", "Передача или повторное использование среды хранения данных без соответствующего уничтожения информации"),
    ("Information", "Передача/потеря контроля носителей криптографических ключей"),
    ("Information", "Отсутствие процедуры безопасного проведения совещаний"),
    ("Information", "Отсутствие процедуры уничтожения информации"),
    ("Information", "Отсутствие или неэффективность процедур контроля доступа"),
    ("Information", "Невыполнение процедур резервного копирования информации"),
    ("Information", "Отсутствие инструкции по действиям в чрезвычайных ситуациях"),
    ("Information", "Отсутствие документов по обращению с ключами электронной цифровой подписи для пользователей"),
    ("Information", "Отсутствие утвержденной процедуры обращения с информацией с ограниченным доступом"),
    ("Information", "Отсутствие плана обеспечения непрерывной работы"),
    ("Information", "Отсутствие формальной процедуры просмотра прав доступа пользователей"),
    ("Information", "Отсутствие или неэффективность политики 'чистого стола и чистого экрана'"),
    ("Information", "Отсутствие средств обнаружения вредоносного ПО"),
    ("Systems", "Отсутствие или несовершенство системы резервного копирования информации"),
    ("Systems", "Отсутствие или несовершенство соглашения об уровне обслуживания третьими сторонами"),
    ("Systems", "Отсутствие или недостаточность требований по информационной безопасности с клиентами и/или третьими сторонами"),
    ("Systems", "Отсутствие или недостаточность тестирования оборудования/программного обеспечения"),
    ("Systems", "Отсутствие или неэффективность идентификации и аутентификации пользователя"),
    ("Systems", "Отсутствие или неэффективность обучения персонала"),
    ("Systems", "Отсутствие или неэффективность процедур контроля доступа"),
    ("Systems", "Отсутствие или неэффективность контроля ввода нового программного обеспечения/оборудования"),
    ("Systems", "Отсутствие определенного дисциплинарного процесса в случае инцидента информационной безопасности"),
    ("Systems", "Отсутствие удаленного резервного пункта"),
    ("Systems", "Отсутствие документации"),
    ("Systems", "Отсутствие документов по обращению с ключами электронной цифровой подписи для пользователей"),
    ("Systems", "Отсутствие документов по обращению с криптографическими ключами для пользователей"),
    ("Systems", "Отсутствие эффективной процедуры мониторинга действий пользователей"),
    ("Systems", "Отсутствие записей о работе пользователей в журналах аудита"),
    ("Systems", "Подделка программного обеспечения"),
    ("Systems", "Отсутствие записей о работе системы защиты в журналах аудита"),
    ("Systems", "Отсутствие контроля за использованием оборудования/программного обеспечения"),
    ("Systems", "Отсутствие контроля за внесением изменений в состав оборудования/программного обеспечения"),
    ("Systems", "Отсутствие контроля системы электропитания"),
    ("Systems", "Отсутствие контроля целостности программного обеспечения при его запуске"),
    ("Systems", "Отсутствие должного определения ответственности за информационную безопасность"),
    ("Systems", "Отсутствие проверки электронной цифровой подписи при работе с электронными документами, хранящимися в базах данных/хранилищах данных/электронных архивах"),
    ("Systems", "Отсутствие проверки целостности программного обеспечения при его запуске"),
    ("Systems", "Отсутствие плана обеспечения непрерывной работы"),
    ("Systems", "Отсутствие политик использования оборудования/программного обеспечения"),
    ("Systems", "Отсутствие регулярных аудитов"),
    ("Systems", "Отсутствие резервных источников электропитания"),
    ("Systems", "Отсутствие резервных каналов связи"),
    ("Systems", "Отсутствие резервного оборудования"),
    ("Systems", "Отсутствие системы мониторинга работы ИТ-инфраструктуры"),
    ("Systems", "Отсутствие формальной процедуры просмотра прав доступа пользователей"),
    ("Systems", "Отсутствие формальной процедуры регистрации и отмены регистрации прав доступа пользователя"),
    ("Systems", "Доступность сервисов, в которых нет необходимости"),
    ("Systems", "Возможность использования оборудования/программного обеспечения не по назначению"),
    ("Systems", "Наличие строительства рядом"),
    ("Systems", "Наличие единой точки отказа"),
    ("Systems", "Наличие незащищенных таблиц паролей"),
    ("Systems", "Наличие незащищенного соединения с публичными сетями"),
    ("Systems", "Неадекватное реагирование на поддержку сервисов"),
    ("Systems", "Опасная архитектура сети"),
    ("Systems", "Неиспользование электронной цифровой подписи для защиты целостности электронных банковских документов"),
    ("Systems", "Несовершенная ИТ система"),
    ("Systems", "Несовершенное или новое программное обеспечение"),
    ("Systems", "Несовершенное программное обеспечение"),
    ("Systems", "Несовершенное управление паролями доступа"),
    ("Systems", "Недостаточный контроль над функционированием и управлением сетью"),
    ("Systems", "Недостаточный контроль над функционированием и управлением сетью/программным обеспечением"),
    ("Systems", "Недостаточная осведомленность персонала в вопросах информационной безопасности"),
    ("Systems", "Неэффективная политика управления сетью"),
    ("Systems", "Неэффективная процедура распространения ключей"),
    ("Systems", "Неэффективное разграничение прав доступа к программному обеспечению/данным"),
    ("Systems", "Неэффективное разграничение прав доступа к программному обеспечению/оборудованию"),
    ("Systems", "Незащищенное соединение с публичными сетями"),
    ("Systems", "Неосведомленность персонала"),
    ("Systems", "Неправильный подбор персонала"),
    ("Systems", "Неправильные настройки установки программного обеспечения"),
    ("Systems", "Некачественная канализационная система"),
    ("Systems", "Передача паролей в открытом виде"),
    ("Systems", "Ошибки при генерации ключей, в том числе генерация ключей без пароля"),
    ("Systems", "Ошибки при проектировании и разработке программного обеспечения в вопросах использования системы криптографической защиты"),
    ("Systems", "Ошибки при проектировании и разработке системы защиты информации"),
    ("Systems", "Нарушение персоналом правил хранения паролей"),
    ("Systems", "Усложненный пользовательский интерфейс"),
    ("Equipment", "Отсутствие или несовершенство системы резервного копирования информации"),
    ("Equipment", "Отсутствие или несовершенство соглашения об уровне обслуживания третьими сторонами"),
    ("Equipment", "Отсутствие или недостаточность требований безопасности в сделках с провайдерами связи"),
    ("Equipment", "Отсутствие или недостаточность тестирования оборудования/программного обеспечения"),
    ("Equipment", "Отсутствие или неэффективность обучения персонала"),
    ("Equipment", "Отсутствие или неэффективность контроля ввода нового программного обеспечения/оборудования"),
    ("Equipment", "Отсутствие определенного дисциплинарного процесса в случае инцидента информационной безопасности"),
    ("Equipment", "Отсутствие удаленного резервного пункта"),
    ("Equipment", "Отсутствие документации"),
    ("Equipment", "Отсутствие экранирования серверного помещения"),
    ("Equipment", "Отсутствие эффективной процедуры мониторинга действий пользователей"),
    ("Equipment", "Отсутствие записей о работе пользователей в журналах аудита"),
    ("Equipment", "Подделка программного обеспечения"),
    ("Equipment", "Отсутствие контроля за внесением изменений в состав оборудования/программного обеспечения"),
    ("Equipment", "Отсутствие контроля за перемещением имущества"),
    ("Equipment", "Отсутствие должного контроля над работниками третьих сторон"),
    ("Equipment", "Отсутствие надлежащего контроля и мониторинга оборудования"),
    ("Equipment", "Отсутствие плана обеспечения непрерывной работы"),
    ("Equipment", "Отсутствие пожарной сигнализации/системы пожаротушения"),
    ("Equipment", "Отсутствие политик использования оборудования/программного обеспечения"),
    ("Equipment", "Отсутствие резервных источников электропитания"),
    ("Equipment", "Отсутствие резервных каналов связи"),
    ("Equipment", "Отсутствие резервного оборудования/программного обеспечения"),
    ("Equipment", "Отсутствие системы мониторинга работы ИТ-инфраструктуры"),
    ("Equipment", "Отсутствие системы пожаротушения"),
    ("Equipment", "Преступные действия"),
    ("Equipment", "Возможность использования оборудования не по назначению"),
    ("Equipment", "Наличие единой точки отказа"),
    ("Equipment", "Неадекватное реагирование на поддержку сервисов"),
    ("Equipment", "Невыполнение процедур резервного копирования информации"),
    ("Equipment", "Небрежность/неопытность персонала"),
    ("Equipment", "Несовершенное или новое программное обеспечение"),
    ("Equipment", "Недостаточный контроль за перемещением имущества"),
    ("Equipment", "Недостаточный контроль над функционированием и управлением сетью"),
    ("Equipment", "Неэффективная система охраны"),
    ("Equipment", "Неэффективное обслуживание оборудования работниками третьих сторон или персоналом компании"),
    ("Equipment", "Неэффективное разграничение прав доступа к программному обеспечению/данным"),
    ("Equipment", "Неконтролируемый ремонт"),
    ("Equipment", "Неправильный подбор персонала"),
    ("Equipment", "Неправильный расчет необходимой мощности электропитания"),
    ("Equipment", "Неправильный расчет мощности оборудования для отвода тепла"),
    ("Equipment", "Некачественная электропроводка"),
    ("Equipment", "Некачественная канализационная система"),
    ("Equipment", "Передача/компрометация паролей доступа"),
    ("Equipment", "Халатность персонала"),
    ("Equipment", "Чувствительность оборудования к электромагнитной радиации"),
    ("Rooms", "Отсутствие удаленного резервного пункта"),
    ("Rooms", "Отсутствие средств оповещения"),
    ("Rooms", "Отсутствие средств пожаротушения"),
    ("Rooms", "Отсутствие инструкции по действиям в чрезвычайных ситуациях"),
    ("Rooms", "Отсутствие контроля системы электропитания"),
    ("Rooms", "Отсутствие пожарной сигнализации"),
    ("Rooms", "Отсутствие резервных источников электропитания"),
    ("Rooms", "Отсутствие резервных каналов связи"),
    ("Rooms", "Отсутствие физической защиты здания, дверей и окон"),
    ("Rooms", "Преступные действия"),
    ("Rooms", "Наличие злонамеренного поджигателя"),
    ("Rooms", "Неадекватный или недостаточный контроль физического доступа"),
    ("Rooms", "Неэффективная система охраны"),
    ("Rooms", "Неконтролируемый ремонт"),
    ("Rooms", "Неосведомленность персонала"),
    ("Rooms", "Нестабильная электросеть"),
    ("Rooms", "Некачественная электропроводка"),
    ("Rooms", "Некачественная канализационная система"),
    ("Personnel", "Отсутствие персонала"),
    ("Personnel", "Неадекватные процедуры приема на работу"),
    ("Personnel", "Отсутствие или недостаточный тренинг по вопросам безопасности"),
    ("Personnel", "Неприемлемое использование программного обеспечения и оборудования"),
    ("Personnel", "Отсутствие осведомленности в вопросах безопасности"),
    ("Personnel", "Отсутствие механизмов мониторинга использования активов"),
    ("Personnel", "Оставление обслуживающего персонала без присмотра"),
    ("Personnel", "Оставление посетителей / визитеров без присмотра"),
    ("Personnel", "Отсутствие политик приемлемого использования оборудования"),
    ("Personnel", "Преступные действия"),
    ("Personnel", "Халатность персонала"),
    ("Service", "Отсутствие или недостаточность требований безопасности в сделках с провайдерами связи"),
    ("Service", "Отсутствие удаленного резервного пункта"),
    ("Service", "Отсутствие контроля системы электропитания"),
    ("Service", "Отсутствие плана обеспечения непрерывной работы"),
    ("Service", "Отсутствие регламентирующих нормативных документов"),
    ("Service", "Отсутствие резервных источников электропитания"),
    ("Service", "Отсутствие резервных каналов связи"),
    ("Service", "Отсутствие резервного оборудования"),
    ("Service", "Злонамеренные действия персонала провайдеров связи"),
    ("Service", "Наличие единой точки отказа"),
    ("Service", "Неадекватное реагирование на поддержку сервисов"),
    ("Service", "Небрежность/неосведомленность персонала")
]

def populate_vulnerabilities():
    # Подключение к базе данных
    with sqlite3.connect('risk_assessment.db') as conn:
        cursor = conn.cursor()
        
        # Проверка наличия таблицы vulnerabilities
        cursor.execute("SELECT name FROM sqlite_master WHERE type='table' AND name='vulnerabilities'")
        if not cursor.fetchone():
            print("Ошибка: таблица 'vulnerabilities' не существует в базе данных.")
            return
        
        # Подсчёт существующих уязвимостей
        cursor.execute('SELECT COUNT(*) FROM vulnerabilities')
        initial_count = cursor.fetchone()[0]
        print(f"Уязвимостей в базе до вставки: {initial_count}")
        
        # Вставка уязвимостей
        inserted = 0
        skipped = 0
        for category, name in vulnerabilities:
            try:
                cursor.execute('INSERT INTO vulnerabilities (name, category) VALUES (?, ?)', (name, category))
                inserted += 1
            except sqlite3.IntegrityError:
                # Пропускаем, если уязвимость уже существует (UNIQUE constraint на name)
                skipped += 1
        
        # Подтверждение изменений
        conn.commit()
        
        # Подсчёт уязвимостей после вставки
        cursor.execute('SELECT COUNT(*) FROM vulnerabilities')
        final_count = cursor.fetchone()[0]
        print(f"Уязвимостей в базе после вставки: {final_count}")
        print(f"Добавлено уязвимостей: {inserted}")
        print(f"Пропущено (уже существуют): {skipped}")

if __name__ == "__main__":
    populate_vulnerabilities()